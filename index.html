<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K Online Shopping</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script> 
    
    <style>
        /* --- CSS VARIABLES --- */
        :root {
            --bg-color: #ffffff; --text-color: #2d2d2d;
            --header-bg: #2d2d2d; --header-text: #ffffff;
            --card-bg: #ffffff; --menu-bg: #ffffff;
            --border-color: #eeeeee; --footer-bg: #ffffff; --input-bg: #eeeeee;
        }
        body.dark-mode {
            --bg-color: #121212; --text-color: #e0e0e0;
            --header-bg: #000000; --header-text: #ffffff;
            --card-bg: #1e1e1e; --menu-bg: #1e1e1e;
            --border-color: #333333; --footer-bg: #121212; --input-bg: #333333;
        }
        body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; margin: 0; padding: 0; background-color: var(--bg-color); color: var(--text-color); overflow-x: hidden; transition: 0.3s; }
        
        /* Header */
        header { background-color: var(--header-bg); color: var(--header-text); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
        .logo { font-size: 18px; font-weight: bold; letter-spacing: 1px; text-transform: uppercase; }
        .nav-icons i { font-size: 20px; margin-left: 15px; cursor: pointer; }

        /* Search */
        #searchContainer { display: none; background: var(--bg-color); padding: 10px; text-align: center; border-bottom: 1px solid var(--border-color); }
        #searchInput { width: 90%; padding: 8px; border: 1px solid var(--border-color); background-color: var(--input-bg); color: var(--text-color); border-radius: 4px; }

        /* Menu */
        .side-menu { height: 100%; width: 280px; position: fixed; z-index: 200; top: 0; left: -280px; background-color: var(--menu-bg); box-shadow: 2px 0 5px rgba(0,0,0,0.3); transition: left 0.3s; display: flex; flex-direction: column; }
        .side-menu.active { left: 0; }
        .menu-top { flex: 1; padding-top: 20px; }
        .menu-bottom { padding: 20px; border-top: 1px solid var(--border-color); display: flex; justify-content: space-around; }
        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 24px; cursor: pointer; }
        .menu-header { padding: 0 20px 20px; border-bottom: 1px solid var(--border-color); font-weight: bold; font-size: 18px; }
        .menu-item { display: flex; justify-content: space-between; padding: 15px 20px; border-bottom: 1px solid var(--border-color); color: var(--text-color); text-decoration: none; font-weight: 500; }
        .menu-item.sale { color: #d32f2f; font-weight: bold; }
        .setting-icon { font-size: 24px; cursor: pointer; text-align: center; }
        .setting-label { font-size: 10px; display: block; margin-top: 5px; text-transform: uppercase; }

        /* Overlay */
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 150; }
        .overlay.active { display: block; }

        /* Products */
        .hero-section { text-align: center; margin-bottom: 20px; }
        .hero-img { width: 100%; height: auto; display: block; }
        .section-title { font-size: 20px; font-weight: bold; padding: 0 15px; margin-top: 30px; display: flex; justify-content: space-between; align-items: center; }
        .shop-link { font-size: 12px; border: 1px solid var(--text-color); padding: 5px 10px; text-decoration: none; color: var(--text-color); }
        .slider-container { display: flex; overflow-x: auto; gap: 15px; padding: 15px; scrollbar-width: none; }
        .product-card { flex: 0 0 160px; background-color: var(--card-bg); padding-bottom: 10px; text-decoration: none; }
        .p-img { width: 100%; height: 220px; object-fit: cover; border-radius: 4px; background: #eee; }
        .p-name { font-size: 13px; margin-top: 10px; color: var(--text-color); height: 36px; overflow: hidden; }
        .p-price { font-weight: bold; margin-top: 5px; font-size: 14px; color: var(--text-color); }

        /* Footer & Chat */
        .main-footer { background-color: var(--footer-bg); text-align: center; padding: 40px 20px; margin-top: 40px; border-top: 1px solid var(--border-color); }
        .footer-title { font-size: 18px; font-weight: bold; margin-bottom: 20px; border-bottom: 1px solid var(--border-color); display: inline-block; padding-bottom: 10px; }
        .chat-box { display: none; position: fixed; bottom: 20px; right: 20px; width: 300px; background: var(--card-bg); z-index: 1000; border: 1px solid var(--border-color); border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .chat-header { background: var(--header-bg); color: var(--header-text); padding: 10px; display: flex; justify-content: space-between; }
        .chat-body { height: 200px; padding: 10px; overflow-y: auto; background: var(--bg-color); }
        .chat-input-area { display: flex; border-top: 1px solid var(--border-color); }
        .chat-input { flex: 1; padding: 10px; border: none; background: var(--input-bg); color: var(--text-color); outline: none; }
        .send-btn { padding: 0 15px; background: var(--header-bg); color: var(--header-text); border: none; }
    </style>
</head>
<body>

    <div class="overlay" onclick="closeAll()"></div>

    <header>
        <div class="menu-icon" onclick="toggleMenu()"><i class="fas fa-bars"></i></div>
        <div class="logo">K Online Shopping</div>
        <div class="nav-icons">
            <i class="fas fa-search" onclick="toggleSearch()"></i>
            <i class="fas fa-headset" onclick="toggleChat()"></i> 
            <i class="fas fa-shopping-bag"></i>
        </div>
    </header>

    <div id="searchContainer">
        <input type="text" id="searchInput" placeholder="Search products...">
    </div>

    <div class="side-menu" id="sideMenu">
        <div class="menu-top">
            <div class="close-btn" onclick="toggleMenu()">&times;</div>
            <div class="menu-header">WOMEN</div>
            <a href="#" class="menu-item">HOME</a>
            <a href="#" class="menu-item sale">SALE</a>
            <a href="#" class="menu-item">NEW IN</a>
            <a href="#" class="menu-item">CLOTHING</a>
            <a href="#" class="menu-item">SHOES</a>
        </div>
        <div class="menu-bottom">
            <div class="setting-icon" onclick="toggleLanguage()"><i class="fas fa-globe"></i><span class="setting-label" id="langLabel">EN</span></div>
            <div class="setting-icon" onclick="toggleTheme()"><i class="fas fa-moon" id="themeIcon"></i><span class="setting-label" id="themeLabel">DARK</span></div>
        </div>
    </div>

    <div class="chat-box" id="chatBox">
        <div class="chat-header"><span>Customer Service</span><i class="fas fa-times" onclick="toggleChat()"></i></div>
        <div class="chat-body" id="chatBody"><div style="background:#eee; padding:8px; border-radius:5px; color:#333;">မင်္ဂလာပါ...</div></div>
        <div class="chat-input-area"><input type="text" id="chatInput" class="chat-input"><button class="send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button></div>
    </div>

    <div class="hero-section">
        <img src="https://images.unsplash.com/photo-1539008835657-9e8e9680c956?auto=format&fit=crop&w=600&q=80" class="hero-img">
    </div>

    <div class="section-title"><span>The Party Preview</span><a href="#" class="shop-link">SHOP NOW</a></div>
    <div class="slider-container" id="partyProductsContainer"><p style="padding:20px;">Loading...</p></div>

    <div class="section-title"><span>Popular Shoes</span><a href="#" class="shop-link">SHOP NOW</a></div>
    <div class="slider-container" id="shoesProductsContainer"><p style="padding:20px;">Loading...</p></div>

    <div class="section-title"><span>New Bag Designs</span><a href="#" class="shop-link">SHOP NOW</a></div>
    <div class="slider-container" id="bagsProductsContainer"><p style="padding:20px;">Loading...</p></div>

    <footer class="main-footer">
        <div class="footer-title">CONTACT US</div>
        <p class="footer-text">Yangon, Myanmar<br>09752965423</p>
        <div class="copyright">@ K Online Shopping 2025</div>
    </footer>

    <script>
        // ***********************************************************
        //  FIXED CONFIGURATION (URL & KEY CORRECTED)
        // ***********************************************************
        
        // ကိုကို့ရဲ့ Screenshot ထဲက URL အမှန် (z တစ်လုံးတည်း)
        const SUPABASE_URL = 'https://bklmuzbkkbhftmdxqopt.supabase.co'; 
        
        // ကိုကို အရင်ပို့ပေးဖူးတဲ့ Key အမှန်
        const SUPABASE_ANON_KEY = 'EyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJrbG11emJra2JoZnRtZHhxb3B0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyOTk1OTAsImV4cCI6MjA3ODg3NTU5MH0.jD7fg_XYSlXPYs1EWIku22DwjjuGVE5WmN8NHx0jvfM'; 

        const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        async function fetchProducts(containerId, limitCount, offsetCount) {
            const container = document.getElementById(containerId);
            if (!container) return;

            // Database Call
            let { data: products, error } = await supabaseClient
                .from('products')
                .select('*')
                .limit(limitCount)
                .range(offsetCount, offsetCount + limitCount - 1);

            if (error) {
                console.error("Supabase Error:", error);
                // URL မှားရင် ဒီ Error ပြပါလိမ့်မယ်
                container.innerHTML = `<p style="padding:20px; color:red;">Connection Failed: ${error.message}</p>`;
                return;
            }

            if (!products || products.length === 0) {
                container.innerHTML = `<p style="padding:20px;">No products found. (Add data in Supabase)</p>`;
                return;
            }

            let htmlContent = '';
            products.forEach(product => {
                const price = product.price ? Number(product.price).toLocaleString() : '0';
                const img = product.image_url ? product.image_url : 'https://via.placeholder.com/160';
                
                htmlContent += `
                    <a href="#" class="product-card">
                        <img src="${img}" class="p-img">
                        <div class="p-name">${product.name || 'No Name'}</div>
                        <div class="p-price">${price} Ks</div>
                    </a>`;
            });
            container.innerHTML = htmlContent;
        }

        // UI Functions
        function toggleMenu() { document.getElementById('sideMenu').classList.toggle('active'); document.querySelector('.overlay').classList.toggle('active'); }
        function closeAll() { document.getElementById('sideMenu').classList.remove('active'); document.querySelector('.overlay').classList.remove('active'); }
        function toggleSearch() { const b = document.getElementById('searchContainer'); b.style.display = b.style.display==="block"?"none":"block"; }
        function toggleChat() { const b = document.getElementById('chatBox'); b.style.display = b.style.display==="block"?"none":"block"; }
        function toggleTheme() { document.body.classList.toggle('dark-mode'); document.getElementById('themeLabel').innerText = document.body.classList.contains('dark-mode') ? "LIGHT" : "DARK"; }
        function toggleLanguage() { alert("Language switch coming soon!"); }
        function sendMessage() { 
            const input = document.getElementById('chatInput');
            if(input.value.trim()){ 
                const d = document.createElement('div'); 
                d.style.cssText="text-align:right; margin:5px 0; color:white;"; 
                d.innerText = input.value; 
                document.getElementById('chatBody').appendChild(d); input.value=""; 
            } 
        }

        // Init
        document.addEventListener('DOMContentLoaded', function() {
            fetchProducts('partyProductsContainer', 3, 0); 
            fetchProducts('shoesProductsContainer', 4, 3); 
            fetchProducts('bagsProductsContainer', 3, 7); 
        });
    </script>
</body>
</html>
